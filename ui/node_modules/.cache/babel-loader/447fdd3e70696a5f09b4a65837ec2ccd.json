{"ast":null,"code":"import axios from 'axios';\nimport { push } from 'connected-react-router';\nimport * as uiActions from 'modules/ui/actions';\nimport * as productActions from 'modules/products/actions';\nconst ADD_TO_CART = 'app/cart/ADD_TO_CART';\nconst REMOVE_FROM_CART = 'app/cart/REMOVE_FROM_CART';\nconst CHECKOUT_SUCCESS = 'app/cart/CHECKOUT_SUCCESS';\n\nfunction addToCart(productId) {\n  return dispatch => {\n    dispatch(uiActions.setFlashMessage('The product has been added to your cart'));\n    dispatch({\n      type: ADD_TO_CART,\n      payload: {\n        productId\n      }\n    });\n  };\n}\n\nfunction loadCart() {\n  return (dispatch, getState) => {\n    const {\n      cart: {\n        productIds\n      }\n    } = getState();\n\n    if (productIds.length === 0) {\n      return dispatch(productActions.clearProducts());\n    }\n\n    const query = productIds.map(id => `id=${id}`).join('&');\n    dispatch(productActions.loadProducts(`?${query}`));\n  };\n}\n\nfunction removeFromCart(productId) {\n  return dispatch => {\n    dispatch({\n      type: REMOVE_FROM_CART,\n      payload: {\n        productId\n      }\n    });\n    dispatch(loadCart());\n  };\n}\n\nfunction checkout(deliveryInfo) {\n  return async (dispatch, getState) => {\n    const {\n      cart: {\n        productIds,\n        price\n      }\n    } = getState();\n    const {\n      data\n    } = await axios.post('/orders', {\n      deliveryInfo,\n      productIds,\n      price\n    });\n    dispatch({\n      type: CHECKOUT_SUCCESS,\n      payload: {\n        order: data\n      }\n    });\n    dispatch(uiActions.setFlashMessage('Your order has been placed'));\n    dispatch(push('/'));\n  };\n}\n\nexport { ADD_TO_CART, REMOVE_FROM_CART, CHECKOUT_SUCCESS, addToCart, loadCart, removeFromCart, checkout };","map":{"version":3,"sources":["/Users/jittananjackthreemongkol/Downloads/react-fundamentals/ui/src/modules/cart/actions.js"],"names":["axios","push","uiActions","productActions","ADD_TO_CART","REMOVE_FROM_CART","CHECKOUT_SUCCESS","addToCart","productId","dispatch","setFlashMessage","type","payload","loadCart","getState","cart","productIds","length","clearProducts","query","map","id","join","loadProducts","removeFromCart","checkout","deliveryInfo","price","data","post","order"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,wBAArB;AAEA,OAAO,KAAKC,SAAZ,MAA2B,oBAA3B;AACA,OAAO,KAAKC,cAAZ,MAAgC,0BAAhC;AAEA,MAAMC,WAAW,GAAG,sBAApB;AACA,MAAMC,gBAAgB,GAAG,2BAAzB;AACA,MAAMC,gBAAgB,GAAG,2BAAzB;;AAEA,SAASC,SAAT,CAAmBC,SAAnB,EAA8B;AAC5B,SAAQC,QAAD,IAAc;AACnBA,IAAAA,QAAQ,CACNP,SAAS,CAACQ,eAAV,CAA0B,yCAA1B,CADM,CAAR;AAGAD,IAAAA,QAAQ,CAAC;AACPE,MAAAA,IAAI,EAAEP,WADC;AAEPQ,MAAAA,OAAO,EAAE;AACPJ,QAAAA;AADO;AAFF,KAAD,CAAR;AAMD,GAVD;AAWD;;AAED,SAASK,QAAT,GAAoB;AAClB,SAAO,CAACJ,QAAD,EAAWK,QAAX,KAAwB;AAC7B,UAAM;AACJC,MAAAA,IAAI,EAAE;AAAEC,QAAAA;AAAF;AADF,QAEFF,QAAQ,EAFZ;;AAIA,QAAIE,UAAU,CAACC,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,aAAOR,QAAQ,CAACN,cAAc,CAACe,aAAf,EAAD,CAAf;AACD;;AAED,UAAMC,KAAK,GAAGH,UAAU,CAACI,GAAX,CAAgBC,EAAD,IAAS,MAAKA,EAAG,EAAhC,EAAmCC,IAAnC,CAAwC,GAAxC,CAAd;AAEAb,IAAAA,QAAQ,CAACN,cAAc,CAACoB,YAAf,CAA6B,IAAGJ,KAAM,EAAtC,CAAD,CAAR;AACD,GAZD;AAaD;;AAED,SAASK,cAAT,CAAwBhB,SAAxB,EAAmC;AACjC,SAAQC,QAAD,IAAc;AACnBA,IAAAA,QAAQ,CAAC;AACPE,MAAAA,IAAI,EAAEN,gBADC;AAEPO,MAAAA,OAAO,EAAE;AACPJ,QAAAA;AADO;AAFF,KAAD,CAAR;AAMAC,IAAAA,QAAQ,CAACI,QAAQ,EAAT,CAAR;AACD,GARD;AASD;;AAED,SAASY,QAAT,CAAkBC,YAAlB,EAAgC;AAC9B,SAAO,OAAOjB,QAAP,EAAiBK,QAAjB,KAA8B;AACnC,UAAM;AACJC,MAAAA,IAAI,EAAE;AAAEC,QAAAA,UAAF;AAAcW,QAAAA;AAAd;AADF,QAEFb,QAAQ,EAFZ;AAIA,UAAM;AAAEc,MAAAA;AAAF,QAAW,MAAM5B,KAAK,CAAC6B,IAAN,CAAW,SAAX,EAAsB;AAC3CH,MAAAA,YAD2C;AAE3CV,MAAAA,UAF2C;AAG3CW,MAAAA;AAH2C,KAAtB,CAAvB;AAMAlB,IAAAA,QAAQ,CAAC;AAAEE,MAAAA,IAAI,EAAEL,gBAAR;AAA0BM,MAAAA,OAAO,EAAE;AAAEkB,QAAAA,KAAK,EAAEF;AAAT;AAAnC,KAAD,CAAR;AACAnB,IAAAA,QAAQ,CAACP,SAAS,CAACQ,eAAV,CAA0B,4BAA1B,CAAD,CAAR;AACAD,IAAAA,QAAQ,CAACR,IAAI,CAAC,GAAD,CAAL,CAAR;AACD,GAdD;AAeD;;AAED,SACEG,WADF,EAEEC,gBAFF,EAGEC,gBAHF,EAIEC,SAJF,EAKEM,QALF,EAMEW,cANF,EAOEC,QAPF","sourcesContent":["import axios from 'axios'\nimport { push } from 'connected-react-router'\n\nimport * as uiActions from 'modules/ui/actions'\nimport * as productActions from 'modules/products/actions'\n\nconst ADD_TO_CART = 'app/cart/ADD_TO_CART'\nconst REMOVE_FROM_CART = 'app/cart/REMOVE_FROM_CART'\nconst CHECKOUT_SUCCESS = 'app/cart/CHECKOUT_SUCCESS'\n\nfunction addToCart(productId) {\n  return (dispatch) => {\n    dispatch(\n      uiActions.setFlashMessage('The product has been added to your cart')\n    )\n    dispatch({\n      type: ADD_TO_CART,\n      payload: {\n        productId,\n      },\n    })\n  }\n}\n\nfunction loadCart() {\n  return (dispatch, getState) => {\n    const {\n      cart: { productIds },\n    } = getState()\n\n    if (productIds.length === 0) {\n      return dispatch(productActions.clearProducts())\n    }\n\n    const query = productIds.map((id) => `id=${id}`).join('&')\n\n    dispatch(productActions.loadProducts(`?${query}`))\n  }\n}\n\nfunction removeFromCart(productId) {\n  return (dispatch) => {\n    dispatch({\n      type: REMOVE_FROM_CART,\n      payload: {\n        productId,\n      },\n    })\n    dispatch(loadCart())\n  }\n}\n\nfunction checkout(deliveryInfo) {\n  return async (dispatch, getState) => {\n    const {\n      cart: { productIds, price },\n    } = getState()\n\n    const { data } = await axios.post('/orders', {\n      deliveryInfo,\n      productIds,\n      price,\n    })\n\n    dispatch({ type: CHECKOUT_SUCCESS, payload: { order: data } })\n    dispatch(uiActions.setFlashMessage('Your order has been placed'))\n    dispatch(push('/'))\n  }\n}\n\nexport {\n  ADD_TO_CART,\n  REMOVE_FROM_CART,\n  CHECKOUT_SUCCESS,\n  addToCart,\n  loadCart,\n  removeFromCart,\n  checkout,\n}\n"]},"metadata":{},"sourceType":"module"}